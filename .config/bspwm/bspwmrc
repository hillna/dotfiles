#! /bin/sh

if ! pgrep sxhkd > /dev/null; then
  echo "Launching sxhkd"
  sxhkd &
fi

# theme
xsetroot -cursor_name left_ptr

bspc config border_width        2
bspc config window_gap         	8

bspc config split_ratio           0.52
bspc config borderless_monocle    false
bspc config gapless_monocle       true

bspc config click_to_focus      button1

bspc config remove_disabled_monitors        true
bspc config remove_unplugged_monitors       true

## Show connected monitors: `xrandr -q`
bspc monitor DisplayPort-1 -d 1 2 3
bspc monitor DisplayPort-0 -d 4 5 6 7
bspc monitor HDMI-A-0 -d 8 9 0

## xps13
bspc monitor eDP-1 -d 1 2 3 4 5 6 7 8 9 0

# xprop | grep WM_CLASS
bspc config external_rules_command ~/.config/bspwm/external-rules.sh
bspc rule -a feh state=floating
bspc rule -a Gimp follow=on state=tiled
bspc rule -a Gladish state=floating
bspc rule -a jack_mixer state=floating
bspc rule -a mplayer state=floating
bspc rule -a net-minecraft-bootstrap-Bootstrap state=floating
bspc rule -a Peek state=floating
bspc rule -a qjackctl state=floating
bspc rule -a Graph - Jack Audio Connection Kit state=tiled
bspc rule -a steam state=tiled
bspc rule -a vlc state=floating
bspc rule -a Wine state=tiled
bspc rule -a QjackCtl state=floating

WALLPAPER=$HOME/.config/bspwm/wallpaper
feh --no-fehbg --bg-max --no-xinerama \
  "$(find $WALLPAPER |shuf -n1)" \
  "$(find $WALLPAPER |shuf -n1)" \
  "$(find $WALLPAPER |shuf -n1)"

# screensaver & lock
if ! pgrep xscreensaver > /dev/null; then
  echo "Launching xscreensaver"
  xscreensaver -no-splash &
fi

## panel
if ! pgrep polybar > /dev/null; then
  echo "Launching polybar"
  $HOME/.config/polybar/launch.sh
fi

## autorun
sleep 2s
autorun=(qjackctl \
         blueman-applet)

for exec in ${autorun[@]}; do
  echo "Launching $exec"
  if ! pgrep $exec > /dev/null; then
    $exec &
  fi
done

